# SDD Overnight Automation Configuration
# Copy this to .env.local and customize

# ─────────────────────────────────────────────
# Slack Configuration
# ─────────────────────────────────────────────

# Channel to scan for feature requests
SLACK_FEATURE_CHANNEL="#feature-requests"

# Keywords to search for in Slack (comma-separated)
SLACK_SEARCH_KEYWORDS="feature request,can we add,would be nice,bug,improvement"

# How many days back to search
SLACK_LOOKBACK_DAYS=7

# Channel to post completion reports (optional)
SLACK_REPORT_CHANNEL="#dev-updates"

# ─────────────────────────────────────────────
# Jira Configuration
# ─────────────────────────────────────────────

# Jira Cloud ID (your-site.atlassian.net or UUID)
JIRA_CLOUD_ID=

# Jira project key (e.g., PROJ, MYAPP)
JIRA_PROJECT_KEY=

# Label that marks issues as ready for auto-implementation
JIRA_AUTO_LABEL=auto-ok

# Issue type to create for new features
JIRA_ISSUE_TYPE=Story

# ─────────────────────────────────────────────
# Integration Options
# ─────────────────────────────────────────────

# Create Jira tickets for Slack requests
CREATE_JIRA_FOR_SLACK=true

# Create Jira tickets for /clone-app features
CREATE_JIRA_FOR_ROADMAP=false

# Keep Jira status in sync with roadmap
SYNC_JIRA_STATUS=true

# Reply to Slack when feature is completed
SLACK_NOTIFY_COMPLETE=true

# ─────────────────────────────────────────────
# Automation Settings
# ─────────────────────────────────────────────

# Maximum features to build per overnight run
MAX_FEATURES=4

# Hours of commits to review for learnings
HOURS_BACK=24

# Create draft PRs automatically (requires gh CLI)
CREATE_PR_ON_COMPLETE=true

# Base branch to sync from and create feature branches from
# - Unset (build-loop): use current branch when you run the script
# - develop: always use develop
# - main: always use main (overnight default)
# - current (overnight only): use whatever branch you're on when script starts
BASE_BRANCH=

# Branch strategy for build scripts (chained|independent|both|sequential)
# - chained: Each feature branches from previous feature (default)
#            Feature #2 has Feature #1's code even if not merged
# - independent: Each feature in a separate git worktree from BASE_BRANCH (isolated)
# - both: Run chained first, then rebuild each feature independently
#         (sequential, not parallel — runs one after the other)
# - sequential: All features on one branch (build-loop-local only)
BRANCH_STRATEGY=chained

# Spec↔code drift checking after each feature build
# When enabled, a SEPARATE agent reads the spec and source files after the
# build agent commits, comparing them with fresh context ("Layer 2" check).
# The build agent also does a self-check ("Layer 1") as part of /spec-first.
DRIFT_CHECK=true

# How many times to retry auto-fixing drift (default: 1)
# If drift is found, the drift agent updates specs to match code.
# If the fix breaks the build, it retries up to this many times.
MAX_DRIFT_RETRIES=1

# ─────────────────────────────────────────────
# Build Validation
# ─────────────────────────────────────────────

# Build check command (auto-detected if empty: tsc, cargo check, go build, etc.)
BUILD_CHECK_CMD=""

# Test check command (auto-detected if empty: npm test, pytest, cargo test, etc.)
TEST_CHECK_CMD=""

# Post-build validation steps (comma-separated)
# Available: test, code-review
# - test: Run test suite after build (failures trigger retry)
# - code-review: Run /code-review agent in fresh context (non-blocking)
POST_BUILD_STEPS="test"

# ─────────────────────────────────────────────
# Model Selection
# ─────────────────────────────────────────────

# Each agent step gets a fresh context window. You can use different
# models for each step (e.g., powerful model for building, cheaper for validation).
# Run `agent --list-models` to see available models.

# Default model for all agent steps (empty = CLI default)
AGENT_MODEL=""

# Per-step overrides (fall back to AGENT_MODEL if empty)
BUILD_MODEL=""                # Main build agent (/build-next → /spec-first)
RETRY_MODEL=""                # Retry agent (fixing build/test failures)
DRIFT_MODEL=""                # Catch-drift agent
REVIEW_MODEL=""               # Code-review agent
TRIAGE_MODEL=""               # Roadmap-triage agent (overnight only)

# Example: Opus for building, cheaper models for validation
# BUILD_MODEL="opus-4.6-thinking"
# DRIFT_MODEL="gemini-3-flash"
# REVIEW_MODEL="sonnet-4.5"

# ─────────────────────────────────────────────
# Paths (usually auto-detected)
# ─────────────────────────────────────────────

# Override project directory if needed
# PROJECT_DIR=/path/to/your/project
